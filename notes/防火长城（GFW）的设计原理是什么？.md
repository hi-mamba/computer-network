

## [原文](http://blog.neargle.com/SecNewsBak/drops/%E7%BF%BB%E5%A2%99%E8%B7%AF%E7%94%B1%E5%99%A8%E7%9A%84%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0%20.html)

# 防火长城（GFW）的设计原理是什么？

编辑备注:因无法联系到原作者以及文章原文声明放弃著作权以及领接权，
因此进行转载，希望作者能够联系邮箱 drops@wooyun.org

## 0x00 开篇
GFW具有重大的社会意义。无论是正面的社会意义，还是负面的意义。无论你是讨厌，还是憎恨。
它都在那里。在可以预见的将来，墙还会继续存在。我们要学会如何与其共存。
我是一个死搞技术的，就是打算搞技术到死的那种人。
当我读到“西厢计划”的博客上的这么一段话时，我被深深的触动了。
不是为了什么政治目的，不是为了什么远大理想，仅仅做为一个死搞技术的人显摆自己的价值，我也必须做些什么。
博客上的原话是这么写的：

> 作为个搞技术的人，我们要干点疯狂的事。
如果我们不动手，我们就要被比我们差的远的坏技术人员欺负。这太丢人了。
眼前就是，GFW这个东西，之前是我们不抱团，让它猖狂了。
现在咱们得凑一起，想出来一个办法让它郁闷一下，不能老被欺负吧。
要不，等到未来，后代会嘲笑我们这些没用的家伙，就象我们说别人“你怎么不反抗？


<http://gfwrev.blogspot.com>

我把翻墙看成一场我们与GFW之间的博弈，是一个不断对抗升级的动态过程。
目前整体的博弈态势来讲是GFW占了绝对的上风。

我们花费了大量的金钱（买VPS买VPN），花费大量时间（学习各种翻墙技术），而GFW只需要简单发几个包，配几个路由规则就可以让你的心血都白费。

GFW并不需要检查所有的上下行流量中是不是有不和谐的内容，很多时候只需要检查连接的前几个包就可以判断出是否要阻断这个连接。
为了规避这种检查，我们就需要把所有的流量都通过第三方代理，还要忍受不稳定，速度慢等各种各样的问题。
花费的是大量的研究的时间，切换线路的时间，找出是什么导致不能用的时间，当然还有服务器的租用费用和带宽费用。
我的感觉是，这就像太极里的四两拨千斤。
GFW只需要付出很小的成本，就迫使了我们去付出很大的反封锁成本，而且这种成本好像是越来越高了。

这场博弈的不公平之处在于，GFW拥有国家的资源和专业的团队。
而我们做为个体，愿意花费在翻墙上的时间与金钱是非常有限的。
在竞争激烈的北上广深，每天辛苦忙碌的白领们。翻墙无非是为了方便自己的工作而已。
不可能在每天上下班从拥挤的地铁中挤出来之后再去花费已经少得可怜的业余时间去学习自己不是翻墙根本不需要知道的名词到底是什么意思。
于是乎，我们得过且过。不用Google也不会死，对不对。
SSH加浏览器设置，搞一搞也就差不多能用就行啦。但是得过且过也越来越不好过了。
从最开始的HTTP代理，到后来的SOCKS代理，到最近的OpenVPN，一个个阵亡。
普通人可以使用的方式越来越少。博弈的天平远远不是平衡的，而是一边倒。


> GFW用技术的手段达到了四两拨千斤的作用。难道技术上就没有办法用四两拨千斤的方法重新扭转这一边倒的局面吗？



办法肯定是有的。我能想到的趋势是两个。第一个趋势是用更复杂的技术，但是提供更简单的使用方式。
简单的HTTP代理，SOCKS明文代理早已阵亡。接下来的斗争需要更复杂的工具。
无论是ShadowSocks还是GoAgent都在向这个方向发展。技术越复杂，意味着普通人要学习要配置的成本就越高。
每个人按照文档，在自己的PC上配置ABC的方式已经不能满足下一阶段的斗争需要了。我们需要提升手里的武器，站在一个更高的平台上。

传统的配置方式的共同特点是终端配置。你需要在你的PC浏览器上，各种应用软件里，手机上，平板电脑上做各种各样的配置。
这样的终端配置的方式在过去是很方便的。别人提供一个代理，你在浏览器里一设置就好用了。
但是在连OpenVPN都被封了的今天，这种终端配置的方式就大大限制了我们的选择。缺点是多方面的：

- 翻墙的方式受到终端支持的限制。特别是手机和平板电脑，不ROOT不越狱的话，选择就非常有限了。

- 终端种类繁多，挂一漏万。提供翻墙的工具的人不可能有精力来测试支持所有种类的终端。

- 如果家里有多个笔记本，还有手机等便携设备使用起来就很不方便。

- 躺在床上要刷Twitter的时候，才发现手机的里的OpenVPN帐号已经被封了，新的那个只配置在了电脑里。

- 最主流的终端是Windows的PC机。但是在Windows上控制底层网络的运作非常不方便。给翻墙工具的作者设置了一个更高的门槛。

- 终端一般处于家庭路由器的后面。大多数直穿的穿墙方式都很难在这种网络环境下工作正常。

把翻墙工具做到路由器上就可以达到实现更复杂的翻墙技术，同时提供极其简单的使用体验。
但是路由器的缺陷也是非常明显的。传统的路由器刷OpenWRT等可以定制的第三方系统有如下缺点：

便携不方便，路由器大部分没有电池，也不方便放在包里
相比在电脑上装一个软件试试好不好使，额外购买专门用来翻墙的路由器未免试用成本也太高了。如果没有人愿意尝试，更加不会有人来使用。
路由器安装软件不方便。笔者花了大量时间研究OpenWRT的USB刷机方式。虽然技术上有所突破，但是仍然感觉不适合普通人操作。

硬件受限。路由器的CPU都很慢。内存非常小。如果不是用C来编写应用，速度会非常慢。
极大地抬高了开发成本。流行的翻墙工具GoAgent和shadowsocks的最初版本都是Python的。
有没有既可以获得路由器的好处，又克服了其缺点的解决方案呢？答案是肯定的。手机做为路由器就可以。
目前fqrouter已经推出了Android版本，把手机变成了翻墙路由器。一方面，完成了平台的跃升，从终端翻墙变为了路由器翻墙。
另外一方面，因为手机的便携，无需额外设备，安装软件简单，而且硬件强大完胜了常规意义上的路由器。使用手机做为路由器之后：

- 翻墙方式不再受到终端的限制。只要能接入路由器，就可以翻墙。

- 提供翻墙工具的人不需要测试所有的终端是不是支持。

- 多种终端可以同时共享一个路由器。无需重复配置。

- 路由器基于的Linux操作系统给翻墙工具的作者提供了极大的便利，新的工具可以更容易地被实现出来。

- 提供了一定的直穿的可能性。

- iPhone, Windows Phone等设备不需要越狱，也可以通过翻墙路由器享受到shadowsocks等更高级的翻墙工具。


   - 未完

